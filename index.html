<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TokyoMap</title>
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css">
    <link href='http://fonts.googleapis.com/css?family=Josefin+Slab:700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="css/style.css">
    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
</head>

<body>

    <div id="header">TOKYO MAP</div>

    <form name="form1" action="">
        <input id="tourism" type="checkbox" /><label for="tourism">観光地</label><br />
        <input id="restaurant" type="checkbox" /><label for="restaurant">レストラン</label><br />
        <input id="hotel" type="checkbox" /><label for="hotel">ホテル</label><br />
        <input type="button" value="更新" onclick="onButtonClick();" />
    </form>

    <div id="map"></div>
    <script>

        //地図のデフォルト値
        var map = L.map('map').setView([35.65863174　, 139.74542422], 14);
        L.control.scale().addTo(map);
        //OSMレイヤー追加
        L.tileLayer(
            'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png'
            ,{
                attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a>',
                maxZoom: 18
            }
        ).addTo(map);

        var markers = new L.FeatureGroup();

        function onButtonClick() {

            if (map.hasLayer(markers)) {
                map.removeLayer(markers);
                markers = new L.FeatureGroup();
            }

            if(document.form1.tourism.checked){
                $.getJSON("./data/map.geojson", function(data) {
                    var geojson = L.geoJson(data, {
                        onEachFeature: function (feature, layer) {
                            layer.bindPopup(feature.properties.name);
                        }
                    });
                    markers.addLayer(geojson);
                });
            }
            if(document.form1.restaurant.checked){
                $.getJSON("./data/restaurant.geojson", function(data) {
                    geojson = L.geoJson(data, {
                        onEachFeature: function (feature, layer) {
                            layer.bindPopup(feature.properties.name);
                        }
                    });
                    markers.addLayer(geojson);
                });
            }
            if(document.form1.hotel.checked){
                $.getJSON("./data/hotel.geojson", function(data) {
                    geojson = L.geoJson(data, {
                        onEachFeature: function (feature, layer) {
                            layer.bindPopup(feature.properties.name);
                        }
                    });
                    markers.addLayer(geojson);
                });
            }
            map.addLayer(markers);

        }
    </script>
</body>
